<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MenÃº | Pupusas y MÃ¡s</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
body{
margin:0;
font-family:'Poppins',sans-serif;
background:#f5efe6;
color:#3b2f2f;
}

header{
background:white;
padding:15px 30px;
box-shadow:0 2px 10px rgba(0,0,0,0.05);
text-align:center;
}

header img{ height:120px; }

section{
max-width:1000px;
margin:auto;
padding:50px 20px;
}

h1{
text-align:center;
font-family:'Playfair Display',serif;
margin-bottom:40px;
}

.category{
margin-top:60px;
}

.category h2{
border-bottom:2px solid #d6b98c;
padding-bottom:8px;
font-family:'Playfair Display',serif;
}

.note{
font-size:14px;
opacity:0.6;
margin-bottom:10px;
}

.menu-item{
display:flex;
justify-content:space-between;
align-items:center;
margin:18px 0;
}

.controls{
display:flex;
align-items:center;
}

.add-btn{
background:#d6b98c;
border:none;
padding:6px 16px;
border-radius:25px;
cursor:pointer;
transition:0.2s;
}

.add-btn:hover{
transform:scale(1.05);
}

.qty-controls{
display:flex;
align-items:center;
}

.qty-controls button{
padding:2px 10px;
margin:0 6px;
border:none;
background:#d6b98c;
border-radius:15px;
cursor:pointer;
}

/* FLOATING CART BUTTON */
.cart-float{
position:fixed;
bottom:25px;
right:25px;
background:#d6b98c;
padding:14px 22px;
border-radius:30px;
cursor:pointer;
box-shadow:0 8px 20px rgba(0,0,0,0.2);
font-weight:600;
z-index:1000;
}

.cart-count{
margin-left:6px;
background:#3b2f2f;
color:white;
padding:3px 7px;
border-radius:50%;
font-size:12px;
}

/* OVERLAY */
.overlay{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.3);
opacity:0;
pointer-events:none;
transition:0.3s;
z-index:900;
}

.overlay.active{
opacity:1;
pointer-events:auto;
}

/* CART PANEL */
.cart{
position:fixed;
top:0;
right:-420px;
width:380px;
height:100%;
background:white;
box-shadow:-4px 0 25px rgba(0,0,0,0.2);
padding:25px;
transition:0.35s ease;
overflow-y:auto;
z-index:1001;
}

.cart.active{
right:0;
}

.cart-header{
display:flex;
justify-content:space-between;
align-items:center;
}

.close-cart{
cursor:pointer;
font-size:22px;
}

.cart-item{
display:flex;
justify-content:space-between;
margin:12px 0;
}

.remove{
cursor:pointer;
color:red;
}

.cart-total{
font-weight:600;
margin-top:15px;
}

input,select,textarea{
width:100%;
padding:8px;
margin:8px 0;
border:1px solid #d6b98c;
border-radius:6px;
}

.checkout-btn{
width:100%;
padding:12px;
background:#d6b98c;
border:none;
border-radius:8px;
margin-top:10px;
cursor:pointer;
font-weight:600;
}

.closed-message{
color:red;
font-weight:600;
text-align:center;
margin-top:10px;
}

.success{
display:none;
text-align:center;
padding:40px;
font-weight:600;
}
</style>
</head>

<body>

<header>
<a href="index.html"><img src="logo.png"></a>
</header>

<section>
<h1>Nuestro MenÃº</h1>

<div class="category">
<h2>Pupusas</h2>

<div class="menu-item"><span>Mixtas â€“ 80 LPS</span><div class="controls" id="Mixtas-control"><button class="add-btn" onclick="addItem('Mixtas',80)">Agregar</button></div></div>
<div class="menu-item"><span>Revueltas â€“ 90 LPS</span><div class="controls" id="Revueltas-control"><button class="add-btn" onclick="addItem('Revueltas',90)">Agregar</button></div></div>
<div class="menu-item"><span>Quesillo â€“ 80 LPS</span><div class="controls" id="Quesillo-control"><button class="add-btn" onclick="addItem('Quesillo',80)">Agregar</button></div></div>

</div>

</section>

<!-- FLOATING CART -->
<div class="cart-float" onclick="toggleCart()">
ðŸ›’ Carrito <span class="cart-count" id="cartCount">0</span>
</div>

<div class="overlay" id="overlay" onclick="toggleCart()"></div>

<!-- CART PANEL -->
<div class="cart" id="cart">
<div class="cart-header">
<h2>Tu Pedido</h2>
<div class="close-cart" onclick="toggleCart()">âœ•</div>
</div>

<div id="cartItems"></div>
<div class="cart-total">Total: <span id="cartTotal">0</span> LPS</div>

<hr>

<textarea id="notas" placeholder="Notas especiales (sin repollo, extra queso...)"></textarea>
<input type="text" id="nombre" placeholder="Nombre">
<input type="tel" id="telefono" placeholder="TelÃ©fono">

<select id="pickupTime">
<option value="">Hora de recogida</option>
<option>15 minutos</option>
<option>30 minutos</option>
<option>45 minutos</option>
<option>1 hora</option>
</select>

<button class="checkout-btn" id="checkoutBtn" onclick="checkout()">Finalizar Pedido</button>
<div class="closed-message" id="closedMessage"></div>

</div>

<div id="successMessage" class="success">
âœ… Pedido enviado correctamente.
</div>

<script>

let cart=JSON.parse(localStorage.getItem("cart"))||{};

function saveCart(){
localStorage.setItem("cart",JSON.stringify(cart));
}

function toggleCart(){
document.getElementById("cart").classList.toggle("active");
document.getElementById("overlay").classList.toggle("active");
}

function addItem(name,price){
cart[name]={price:price,qty:1};
renderMenuControl(name);
renderCart();
saveCart();
}

function changeQty(name,amount){
cart[name].qty+=amount;
if(cart[name].qty<=0){
delete cart[name];
resetControl(name);
}
renderCart();
renderMenuControl(name);
saveCart();
}

function resetControl(name){
let id=name+"-control";
document.getElementById(id).innerHTML=
`<button class="add-btn" onclick="addItem('${name}',${cart[name]?.price||0})">Agregar</button>`;
}

function renderMenuControl(name){
if(!cart[name]) return;
let id=name+"-control";
document.getElementById(id).innerHTML=
`<div class="qty-controls">
<button onclick="changeQty('${name}',-1)">âˆ’</button>
${cart[name].qty}
<button onclick="changeQty('${name}',1)">+</button>
</div>`;
}

function renderCart(){
let cartItems=document.getElementById("cartItems");
cartItems.innerHTML="";
let total=0;
let count=0;

for(let item in cart){
total+=cart[item].price*cart[item].qty;
count+=cart[item].qty;

cartItems.innerHTML+=`
<div class="cart-item">
${cart[item].qty} ${item}
<span>${cart[item].price*cart[item].qty} LPS</span>
<span class="remove" onclick="changeQty('${item}',-999)">ðŸ—‘</span>
</div>`;
}

document.getElementById("cartTotal").innerText=total;
document.getElementById("cartCount").innerText=count;
}

function isOpen(){
let now=new Date();
let day=now.getDay();
if(day===0) return false;

let hours=now.getHours();
let minutes=now.getMinutes();
let current=hours*60+minutes;

let morningOpen=7*60+30;
let morningClose=13*60+30;
let eveningOpen=17*60;
let eveningClose=21*60;

return (current>=morningOpen && current<=morningClose) ||
(current>=eveningOpen && current<=eveningClose);
}

function checkHours(){
if(!isOpen()){
document.getElementById("checkoutBtn").disabled=true;
document.getElementById("closedMessage").innerText="Estamos cerrados en este momento.";
}
}

function checkout(){
if(!isOpen()){
alert("Estamos cerrados.");
return;
}

let nombre=document.getElementById("nombre").value;
let telefono=document.getElementById("telefono").value;
let pickup=document.getElementById("pickupTime").value;
let notas=document.getElementById("notas").value;

let total=0;
let orderText="";

for(let item in cart){
orderText+=`â€¢ ${cart[item].qty} ${item}\n`;
total+=cart[item].price*cart[item].qty;
}

let message=
`ðŸ›Žï¸ Nuevo Pedido\n\n`+
`ðŸ‘¤ ${nombre}\n`+
`ðŸ“ž ${telefono}\n`+
`â° ${pickup}\n\n`+
`ðŸ“ Pedido:\n${orderText}\n`+
`ðŸ—’ Notas: ${notas}\n\n`+
`ðŸ’° Total: ${total} LPS`;

fetch("https://formsubmit.co/ajax/pupusasymashn@gmail.com",{
method:"POST",
headers:{'Content-Type':'application/json'},
body:JSON.stringify({
name:nombre,
message:message,
_subject:"Nuevo Pedido - Pupusas y MÃ¡s"
})
});

window.open(`https://wa.me/50487809196?text=${encodeURIComponent(message)}`,'_blank');

localStorage.removeItem("cart");
cart={};
renderCart();
document.getElementById("successMessage").style.display="block";
toggleCart();
}

renderCart();
checkHours();

</script>

</body>
</html>
